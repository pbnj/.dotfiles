# vim:et:ts=2:sts=2:sw=2
# SENSIBLE

set-option -g automatic-rename on
set-option -g automatic-rename-format '#{b:pane_current_path}'
set-option -g base-index 1
set-option -g history-limit 20000
set-option -g mode-keys vi
set-option -g mouse on
set-option -g pane-base-index 1
set-option -g renumber-windows on
set-option -g set-clipboard on
set-option -g status on
set-option -g status-interval 1
set-option -g status-left ''
set-option -g status-position top
set-option -g status-right '#{?client_prefix,#[reverse][prefix]#[noreverse],} #(tmux-mem-cpu-load)'
set-option -g status-right-length 200
set-option -g status-style 'bg=default'
set-option -g window-status-current-format "[#[bold]#W#[default]]"
set-option -g window-status-format '[#I]'
set-option -g wrap-search off
set-option -s escape-time 0

if-shell '[[ $(uname -s) == Darwin ]]' { set -s copy-command 'pbcopy' }

###############################################################################
# KEYBINDINGS
###############################################################################

## https://gist.github.com/brendanhay/1769870#gistcomment-2334245
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T edit-mode-vi Down send-keys -X history-down
bind-key -T edit-mode-vi Up send-keys -X history-up
bind-key C-[ copy-mode
bind-key / copy-mode \; send-key / # prefix + / to search down
bind-key ? copy-mode \; send-key ? # prefix + / to search down

## productivity
bind-key C-u run-shell -b 'open-url'                                                                                    # [u]rl fuzzy searcher & launcher. See `utils/.local/bin/open-url` for implementation
bind-key C-f run-shell -b 'find ~/Projects -type d | fzf-tmux --multi --reverse | xargs -L1 -I{} tmux new-window -c {}' # [f]uzzylfind directories and open them in new tmux windows
bind-key C-o run-shell -b 'git -C # {pane_current_path} browse-fzf'                                                     # [o]pen git files in git remote. See `utils/.local/bin/git-browse-fzf` for implementation
bind-key C-t run-shell -b 'tmux new-window -h htop'                                                                     # h[t]op launcher
bind-key -T root C-_ split-window -v -c '#{pane_current_path}'
bind-key -T root C-\\ split-window -h -c '#{pane_current_path}'

## quick pane switching
bind-key  -T  root  M-1  select-window  -t  :=1
bind-key  -T  root  M-2  select-window  -t  :=2
bind-key  -T  root  M-3  select-window  -t  :=3
bind-key  -T  root  M-4  select-window  -t  :=4
bind-key  -T  root  M-5  select-window  -t  :=5
bind-key  -T  root  M-6  select-window  -t  :=6
bind-key  -T  root  M-7  select-window  -t  :=7
bind-key  -T  root  M-8  select-window  -t  :=8
bind-key  -T  root  M-9  select-window  -t  :=9

## from: https://github.com/tmux-plugins/tmux-pain-control/blob/master/pain_control.tmux
### Window nav
bind-key  '<'  swap-window    -t  -1
bind-key  '>'  swap-window    -t  +1
bind-key  'c'  new-window     -c  '#{pane_current_path}'
bind-key  C-n  select-window  -n
bind-key  C-p  select-window  -p

## Spliting windows
bind-key  'v'   split-window  -h   -c  '#{pane_current_path}'  #  <prefix>b  +  v  :  split  horizontal
bind-key  "\\"  split-window  -h   -c  '#{pane_current_path}'  #  <prefix>b  +  \  :  split  horizontal
bind-key  'V'   split-window  -fh  -c  '#{pane_current_path}'  #  <prefix>b  +  V  :  split  horizontal  full
bind-key  '|'   split-window  -fh  -c  '#{pane_current_path}'  #  <prefix>b  +  |  :  split  horizontal  full
bind-key  's'   split-window  -v   -c  '#{pane_current_path}'  #  <prefix>b  +  s  :  split  vertical
bind-key  '-'   split-window  -v   -c  '#{pane_current_path}'  #  <prefix>b  +  -  :  split  vertical
bind-key  'S'   split-window  -fv  -c  '#{pane_current_path}'  #  <prefix>b  +  S  :  split  vertical    full
bind-key  '_'   split-window  -fv  -c  '#{pane_current_path}'  #  <prefix>b  +  _  :  split  vertical    full
bind-key  '%'   split-window  -h   -c  '#{pane_current_path}'  #  <prefix>b  +  %  :  split  horizontal  default
bind-key  "'"   split-window  -v   -c  '#{pane_current_path}'  #  <prefix>b  +  "  :  split  vertical    default

## Panes nav
bind-key  C-h  select-pane  -L
bind-key  C-j  select-pane  -D
bind-key  C-k  select-pane  -U
bind-key  C-l  select-pane  -R
unbind C-o ## pane rotation is annoying
bind-key C-o select-pane -t :.+
