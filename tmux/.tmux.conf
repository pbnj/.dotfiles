# SENSIBLE

set-option -g automatic-rename on
set-option -g automatic-rename-format '#{b:pane_current_path}'
set-option -g base-index 1
set-option -g default-terminal 'screen-256color'
set-option -g history-limit 20000
set-option -g mouse on
set-option -g renumber-windows on
set-option -g set-clipboard on
set-option -g status on
set-option -g status-interval 1
set-option -g status-position bottom
set-option -g status-left ''
set-option -g status-right '#{?client_prefix,#[reverse][prefix]#[noreverse],} #(tmux-mem-cpu-load)'
set-option -g status-right-length 200
set-option -g status-style 'bg=default'
set-option -g terminal-overrides ',xterm-256color:RGB'
set-option -g wrap-search off
set-option -s escape-time 0
set-option -g window-status-current-format '[#[bold]#W #[nobold]#(gitmux -cfg $HOME/.config/git/gitmux.yaml #{pane_current_path})#[default]]'
set-option -g window-status-format '[#I]'
set-option -g mode-keys vi
set-option -g pane-base-index 1

if-shell '[[ $(uname -s) == Darwin ]]' { set -s copy-command 'pbcopy' }

###############################################################################
# KEYBINDINGS
###############################################################################

# pane rotation is annoying
unbind C-o

# https://gist.github.com/brendanhay/1769870#gistcomment-2334245
bind-key -T copy-mode-vi v send -X begin-selection
bind-key -T edit-mode-vi Down send-keys -X history-down
bind-key -T edit-mode-vi Up send-keys -X history-up
bind-key C-[ copy-mode
bind-key / copy-mode \; send-key / # prefix + / to search down

bind-key C-u run-shell -b 'open-url'
bind-key C-c run-shell -b 'open-project'

# Open git files in remote repositories in the browser.
# Requires: tmux, git, fzf-tmux (ships with fzf), git-extras
bind-key C-g run-shell -b "git -C #{pane_current_path} ls-files --full | fzf-tmux --reverse --multi | xargs -L1 git -C #{pane_current_path} browse $(git -C #{pane_current_path} config branch.""$(git -C #{pane_current_path} rev-parse --abbrev-ref HEAD 2>/dev/null)"".remote || echo 'origin')"

########################################
# WINDOW/PANE CONTROLS
# https://github.com/tmux-plugins/tmux-pain-control/blob/master/pain_control.tmux
########################################

# Windows
## Nav
bind-key '<' swap-window -t -1
bind-key '>' swap-window -t +1
bind-key 'c' new-window -c '#{pane_current_path}'
bind-key C-n select-window -n
bind-key C-p select-window -p

## Spliting
bind-key 'v' split-window -h -c '#{pane_current_path}'   # <prefix>b + v : split horizontal
bind-key "\\" split-window -h -c '#{pane_current_path}'  # <prefix>b + \ : split horizontal
bind-key 'V' split-window -fh -c '#{pane_current_path}'  # <prefix>b + V : split full horizontal
bind-key '|' split-window -fh -c '#{pane_current_path}'  # <prefix>b + | : split full horizontal
bind-key 's' split-window -v -c '#{pane_current_path}'   # <prefix>b + s : split vertical
bind-key '-' split-window -v -c '#{pane_current_path}'   # <prefix>b + - : split vertical
bind-key 'S' split-window -fv -c '#{pane_current_path}'  # <prefix>b + S : split full vertical
bind-key '_' split-window -fv -c '#{pane_current_path}'  # <prefix>b + _ : split full vertical
bind-key '%' split-window -h -c '#{pane_current_path}'   # <prefix>b + % : default split horizontal
bind-key "'" split-window -v -c '#{pane_current_path}'   # <prefix>b + " : default split vertical

# Panes
## Nav
bind-key C-h select-pane -L
bind-key C-j select-pane -D
bind-key C-k select-pane -U
bind-key C-l select-pane -R
